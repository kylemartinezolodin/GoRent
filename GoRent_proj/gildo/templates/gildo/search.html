<!DOCTYPE html>
{%load static%}
<html lang="en">
<head>
    <link rel = "icon" href = "{% static 'gildo/img/gorent_icon.png' %}" type = "image/png"> 
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <title>GoRent | Search</title>
    
<!--

Tooplate 2095 Level

https://www.tooplate.com/view/2095-level

-->
    <!-- load stylesheets -->
    <link rel="stylesheet" href="{% static 'gildo/https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700' %}">  <!-- Google web font "Open Sans" -->
    <link rel="stylesheet" href="{% static 'gildo/font-awesome-4.7.0/css/font-awesome.min.css' %}">                <!-- Font Awesome -->
    <link rel="stylesheet" href="{% static 'gildo/css/bootstrap.min.css' %}">                                      <!-- Bootstrap style -->
    <link rel="stylesheet" type="text/css" href="{% static 'gildo/slick/slick.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'gildo/slick/slick-theme.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'gildo/css/datepicker.css' %}"/>
    <link rel="stylesheet" href="{% static 'gildo/css/tooplate-style.css' %}">                                   <!-- Templatemo style -->
    <link rel="stylesheet" href="{% static 'search/css/page_styles.css' %}">  <!-- MAIN PAGE TOPNAV AND MAP  STYLES -->
    <link rel="stylesheet" href="{% static 'search/css/sidepanel_left.css' %}">  <!-- MAIN PAGE ADD SPACE STYLES -->
    <link rel="stylesheet" href="{% static 'search/css/sidepanel_right.css' %}">  <!-- MAIN PAGE NEARBY LISTING STYLES -->
    <link rel="stylesheet" href="{% static 'search/css/map_styles.css' %}">  <!-- MAIN PAGE MAP STYLES -->


    <!-- LEAFLET CSS (AND JS IT IS REQUIRED THAT JS SHOULD BE PUT AFTER THE CSS)-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" 
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/> <!-- BASE LEAFLET STYLES -->
    <link rel="stylesheet" href="{% static 'js/leaflet/geosearch.js' %}">  <!-- LEAFLET COORDINATES STYLES -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch@3.0.0/dist/geosearch.css"/> <!-- LEAFLET GEOSEARCH STYLES -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin="">
    </script><!-- BASE LEAFLET JS -->
    <script src="https://unpkg.com/leaflet-geosearch@3.0.0/dist/geosearch.umd.js"></script> <!-- LEAFLET ADD-ON GEOSEARCH JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" /> <!-- LEAFLET ADD-ON leaflet-control-geocoder STYLES -->
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script> <!-- LEAFLET ADD-ON leaflet-control-geocoder JS -->
    <script src="{% static 'js/leaflet/geosearch.js' %}"></script> <!-- LEAFLET ADD-ON leaflet-geoip JS -->
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
          <![endif]-->
</head>

    <body>
        <div class="tm-main-content" id="top">
            
            <!-- CUSTOM TOP NAVBAR  NI OLODIN-->
            <!-- <div class="gorent-top-navbar">
                <div class="top-navbar-left_group">
                    <div class="container-logo">
                        <img src="{% static 'img/gorent_icon.png' %}" alt="Site logo">
                        <img src="{% static 'img/gorent_plain.png' %}" alt="Site logo">
                    </div>
                </div>

                <div class="container-topnav_buttons">
                    <a class="topnav_button" href="#">About Us</a>
                    <a class="topnav_button" href="#">Register your space</a>
                </div>
                
            </div> -->

            <!-- <div class="tm-top-bar-bg"></div>
            <div class="tm-top-bar" id="tm-top-bar"> -->
                <!-- Top Navbar -->
                <div class="container">
                    <div class="row">
                        
                        <nav class="navbar navbar-expand-lg narbar-light">
                            <a class="navbar-brand mr-auto" href="#">
                                <img src="img/gorent_icon.png" alt="Site logo">
                                <img src="img/gorent_plain.png" alt="Site logo">
                            </a>
                            <button type="button" id="nav-toggle" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#mainNav" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                            <div id="mainNav" class="collapse navbar-collapse tm-bg-white">
                                <ul class="navbar-nav ml-auto">
                                    <li class="nav-item">
                                        <a class="nav-link" href="#top">About Us <span class="sr-only">(current)</span></a>
                                    </li>

                                    {% if user is None %} <!-- IF "user" EXIST IN CONTEXT -->
                                    <li class="nav-item">
                                        <a class="nav-link" href="{% url 'registers:about_view' %}">Register your space</a>
                                    </li>
                                    {% else %}
                                    <li class="nav-item">
                                        <a class="nav-link" href="settings.html">{{user.fistname}}{{user.lastname}}</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{% url 'registers:logout_view' %}">logout</a>
                                    </li>
                                    {% endif %}
                                    <!-- <li class="nav-item">
                                        <a class="nav-link active" href="#tm-section-5">Rent</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="Billing.html">Billings</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="#tm-section-6" >My Account</a>
                                    </li> -->
                                </ul>
                            </div>                            
                        </nav>            
                    </div> 

                </div>
            </div>

            <!-- MAP -->
            <div id="map" class="map_viewport">

                <!-- MAP SEARCH BAR -->
                <!-- <div class="container-map_searchbar">
                    <input type="text" name="" id="" class="map_seachbar">
                    
                    <div class="map_search_results">
                        Spain, Skimberlo 6000
                    </div>
                </div>
                -->
                
                {% if user is None %}

                <!-- NEARBY LIST BLOCK -->
                <div class="map-sidepanel-right">
                    
                    <button id="button-manual_locate" onclick="toggleMapLocate()">Pick Location on Map</button>
                    <button id="button-auto_locate"  onclick="getLocation()">Enable Location</button>

                    <form action="index.html" method="get" class="">
                        {% csrf_token %}
                        <input name="price" type="text" class="" id="inputLocation" placeholder="Budget (PHP)">
                    </form>

                    Nearby spaces: (ANG ORDER SA MGA SPACES KAY USING DISTANCE FORMULA)
                    <br>
                    <div id="location"></div>
                    <div id="container-nearby_list_loading_screen" class="container-nearby_list_loading_screen" style="display: none;">
                        LOADING (LOADING SCREEN NI KUNG KAYA DESIGNA NI, PERO LOW PRIORITY JUD ANG DESIGNx2)
                    </div>
                    <div id="container-nearby_list" class="container-nearby_list" style="display: none;">
                        <div class="container-nearby_list_items">
                            <div>
                                Crown Regency
                            </div>
                            <div>
                            Fuente 12356 Kalsada St., Cebu City
                            </div>
                            <div>
                            [Some Image][Some Image][Some Image]
                            </div>
                            (SPACE KUNUHAY NI)
                            <button>Send Application</button>
                        </div>
                        <div class="container-nearby_list_items">
                            <div>
                                GV TOWER
                            </div>
                            <div>
                                Colon 12356 Kalsada St., Cebu City
                            </div>
                            <div>
                                [Some Image][Some Image][Some Image]
                            </div>
                            (SPACES KUNUHAY NI)
                            <button>Send Application</button>
                        </div>
                        <div class="container-nearby_list_items">
                            <div>
                                Queensland
                            </div>
                            <div>
                                Colon 12356 Kalsada St., Cebu City
                            </div>
                            <div>
                                NO IMAGE
                            </div>
                            (SPACES KUNUHAY NI)
                            <button>Send Application</button>
                        </div>
                    </div>

                </div>

                {% else %}
                
                    {% if type == "RentOwner" %}
                <div class="map-sidepanel-left">
                    Add/Register Space
                    <br>
                    <button id="button-manual_locate" onclick="toggleMapLocate()">Pick Location on Map</button>
                    <button id="button-auto_locate"  onclick="getLocation()">Enable Location</button>
                    <div id="location"></div>
                    
                    <button id="button-add_space_image" style="display:none">Add Image</button>
                    <button id="button-submit_space" style="display:none">Submit</button>
                </div>
                    {% endif %}

                <!-- NEARBY LIST BLOCK -->
                <div class="map-sidepanel-right">
                    Request List: (MGA LISTAHAN NGA GANAHAN MO AVAIL SA ILA SPACE)
                    <br>
                    <div id="container-request_list" class="container-request_list">
                        <div class="container-request_list_items">
                            <div>
                                [Some User Image] [Firstname] [Lastname]
                            </div>
                            <div>
                                Email: [Email] <br>
                                Contact: [contact_number]
                            </div>
                            <button>Accept</button>
                            <button>Reject</button>
                            <br>
                            (REQUEST KUNUHAY NI)
                        </div>
                        <div class="container-request_list_items">
                            <div>
                                [Some User Image] [Firstname] [Lastname]
                            </div>
                            <div>
                                Email: [Email] <br>
                                Contact: [contact_number]
                            </div>
                            <button>Accept</button>
                            <button>Reject</button>
                            <br>
                            (REQUEST KUNUHAY NI)
                        </div>
                        <div class="container-request_list_items">
                            <div>
                                [Some User Image] [Firstname] [Lastname]
                            </div>
                            <div>
                                Email: [Email] <br>
                                Contact: [contact_number]
                            </div>
                            <button>Accept</button>
                            <button>Reject</button>
                            <br>
                            (REQUEST KUNUHAY NI)
                        </div>
                    </div>

                </div>

                {% endif %}

                <script type="text/javascript">
                    
                    // ADD MARKER SAMPLE CODE
                    markers = [
                        L.marker([10.3157, 123.8854]),
                        L.marker([10.30, 123.700]),
                    ]


                    user_flag = {% if user is None %} false {% else %} true {% endif %};
                    user_locate = {
                        isLocating: false, // BECOMES TRUE IF USER IS MANUALLY LOCATING 
                        location: null,
                        address: null, // L.Control.Geocoder FROM: https://github.com/perliedman/leaflet-control-geocoder/tree/1.13.0#lcontrolgeocoder IS ASYCNHRONOUS THUS WHY WE NEED TO UPDATE AFTER user_locate.address IS UPDATED
                        addressListener: function (val) { // A MAKESHIFT LISTENER WHEN address PROPERTY IS CHANGED
                            if (user_flag)
                                fillSpaceInfo() // USED WHEN LOGGED IN
                            else
                                activateNearbyList() // USED WHEN RENTEE
                        },
                        set address(val) { // OVERIDING SETTER (I.E. user_locate.address = [some_value] EVENT)
                            this._address = val // THE UNDERSCORE/"_" AFTER THE address IS VERY VITAL TO AVOID RECURSSION
                            this.addressListener(val);
                        },
                        get address() { // OVERIDING GETTER (I.E. console.log(user_locate.address) EVENT)
                            return this._address // THE UNDERSCORE/"_" AFTER THE address IS VERY VITAL TO AVOID RECURSSION
                        },
                    }
                    
                    // A MAKESHIFT SLEEP() FROM: https://www.sitepoint.com/delay-sleep-pause-wait/
                    function sleep(ms) {
                        return new Promise(resolve => setTimeout(resolve, ms));
                    }
                    
                    async function toggleMapLocate () { // IT IS ASYNCH BECUASE IT USES THE MAKESHIFT SLEEP() FROM: https://www.sitepoint.com/delay-sleep-pause-wait/
                        await sleep(100)
                        // setTimeout(function() {
                        //     user_locate.isLocating = !user_locate.isLocating // locate IS A BOOLEAN
                        // }, 100);
                        user_locate.isLocating = !user_locate.isLocating
                        console.log("isLocating:" +user_locate.isLocating)
                    }

                    function getLocation() {
                        if (navigator.geolocation) { // CHECKS IF GEOLOCATION IS SUPPORTED IN THE BROWSER
                            navigator.geolocation.getCurrentPosition(showLocation);
                        } else {
                            document.querySelector("#location").innerHTML = "Geolocation is not supported by this browser. Manully pick location instead";
                            document.querySelector("#button-auto_locate").style.display = "none"
                        }
                    }

                    function activateNearbyList () { // HAPPENS IF user_locate.location IS NO LONGER NULL
                        document.querySelector("#location").innerHTML = "ANG CURRENT NGA COORDINATES KAY: " +"[lat:" +user_locate.location.lat +", lng: " +user_locate.location.lng +"] GAMITA NI PARA DISTANCE FORMULA"

                        document.querySelector("#button-manual_locate").innerHTML = "Pick Another Location"
                        document.querySelector("#button-auto_locate").style.display = "none"
                        document.querySelector("#container-nearby_list").style.display = "block"
                    }
                    
                    function fillSpaceInfo () { // HAPPENS IF user_locate.location IS NO LONGER NULL
                        document.querySelector("#location").innerHTML = "ANG ADDRESS KAY: " +user_locate.address +" NYA COORDINATES KAY: " +"[lat:" +user_locate.location.lat +", lng: " +user_locate.location.lng +"] GAMITA NI PARA MAKA ADD OG SPACE"

                        document.querySelector("#button-manual_locate").innerHTML = "Pick Another Location"
                        document.querySelector("#button-auto_locate").style.display = "none"
                        document.querySelector("#button-submit_space").style.display = "block"
                        document.querySelector("#button-add_space_image").style.display = "block"
                    }

                    function toggleLoadingScreen () { // WALA PA GI GAMIT KAY MURAG MO CAUSE OG PROBLEM, ANYWAY AESTHETICS RAMNSAD NI NGA FUNCTIONALITIES
                        loading_screen = document.querySelector("#container-nearby_list_loading_screen")
                        if (loading_screen.style.display == "none") {
                            loading_screen.style.display = "block"
                            document.querySelector("#container-nearby_list").style.display = "none"
                        }
                        else {
                            loading_screen.style.display = "none"
                            document.querySelector("#container-nearby_list").style.display = "block"
                        }
                    }

                </script>
            </div>

            <!-- GILDO'S BODY CURRENTLY HIDDEN -->
            <div class="tm-section tm-bg-img" id="tm-section-1" style="display: none">
                <div class="tm-bg-green ie-container-width-fix-2">
                    <div class="container ie-h-align-center-fix">
                        <div class="row">
                            <div class="col-xs-12 ml-auto mr-auto ie-container-width-fix">
                                <form action="index.html" method="get" class="tm-search-form tm-section-pad-2">
                                    {% csrf_token %}
                                    <div class="form-row tm-search-form-row">
                                        <div class="form-group tm-form-element tm-form-element-2">
                                            <i class="fa fa-map-marker fa-2x tm-form-element-icon"></i>
                                            <input name="location" type="text" class="form-control" id="inputLocation" placeholder="Location...">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-2">                                            
                                            <select name="adult" class="form-control tm-select" id="adult">
                                                <option value="">Housing Type</option>
                                                <option value="1">Boarding House</option>
                                                <option value="2">Apartment</option>
                                                <option value="3">Dormitory</option>
                                                <option value="4">Semi-Owned House</option>
                                            </select>
                                            <i class="fa fa-2x fa-home tm-form-element-icon"></i>
                                        </div>
<!--                                         
                                    </div>
                                    <div class="form-row tm-search-form-row"> -->
                                        <div class="form-group tm-form-element tm-form-element-2">                                            
                                            <select name="children" class="form-control tm-select" id="children">
                                                <option value="">Budget (Php)</option>
                                                <option value="0">Any</option>
                                                <option value="1">Below 500</option>
                                                <option value="2">1,000 to 3,000</option>
                                                <option value="3">3,000 to 5,000</option>
                                                <option value="4">5,000 to 7,000</option>
                                                <option value="5">Above 7,000</option>
                                            </select>
                                            <i class="fa fa-money tm-form-element-icon tm-form-element-icon-small"></i>
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-2">
                                            <select name="room" class="form-control tm-select" id="room">
                                                <option value="">Single Space</option>
                                                <option value="1">2-person</option>
                                                <option value="1">3-person</option>
                                                <option value="1">4-person</option>
                                            </select>
                                            <i class="fa fa-2x fa-bed tm-form-element-icon"></i>
                                        </div>
                                        
                                      </div>
                                      
                                      <!-- <div class="form-row clearfix pl-2 pr-2 tm-fx-col-xs">
                                          
                                          
                                          <div class="form-group tm-form-element tm-form-element-2">
                                            
                                            <a href="#" class="ie-10-ml-auto ml-auto mt-1 tm-font-semibold tm-color-primary">Need Help?</a> 
                                        </div>
                                        
                                        <button type="submit" class="btn btn-primary tm-btn-search">GoRent</button>
                                        
                                      </div> -->
                                      <!-- Content Map -->
                                      
                                      <div class="left-column">
                                        <div class="column-content">
                                            
                                                <div id="map1"></div>        
                                                
                                        </div>

                                      </div>
                                    
                                    <div class="column-space">
                                        <p></p>
                                    </div>
                                    <div class="right-column">
                                        <div class="column-content">
                                            <h6>Rentee Rating: * * * * *</h6>
                                            <br>Late Payment: [0]
                                            <br>Advance Payment: [4]
                                        </div>
                                    </div>
                                    <div class="column-space">
                                        <p></p>
                                    </div>
                                    <div class="right-column">
                                        <div class="column-content">
                                            <h6>Rentee Rating: * * * * *</h6>
                                            <br>Late Payment: [0]
                                            <br>Advance Payment: [4]
                                        </div>
                                    </div>
                                    <div class="column-space">
                                        <p></p>
                                    </div>
                                    <div class="right-column">
                                        <div class="column-content">
                                            <h6>Rentee Rating: * * * * *</h6>
                                            <br>Late Payment: [0]
                                            <br>Advance Payment: [4]
                                        </div>
                                    </div>
                                    
                                    <input  type="submit" class="button special Search-btn" value="submit">
                                </form>
                                
                            </div>                        
                        </div>      
                    </div>
                </div>                  
            </div>
            
            <!-- <div class="tm-section tm-section-pad tm-bg-img tm-position-relative" id="tm-section-6">
                <div class="container ie-h-align-center-fix">
                    <div class="row">
                        
                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-5 mt-3 mt-md-0">
                            <div class="tm-bg-white tm-p-4">
                                <form action="index.html" method="post" class="contact-form">
                                    <div class="form-group">
                                        <input type="text" id="contact_name" name="contact_name" class="form-control" placeholder="Name"  required/>
                                    </div>
                                    <div class="form-group">
                                        <input type="email" id="contact_email" name="contact_email" class="form-control" placeholder="Email"  required/>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="contact_subject" name="contact_subject" class="form-control" placeholder="Subject"  required/>
                                    </div>
                                    <div class="form-group">
                                        <textarea id="contact_message" name="contact_message" class="form-control" rows="9" placeholder="Message" required></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary tm-btn-primary">Send Message Now</button>
                                </form>
                            </div>                            
                        </div>
                    </div>        
                </div>
            </div> -->


            <!-- GILDO'S FOOTER CURRENTLY HIDDEN -->
            <footer class="tm-bg-primary" style="display: none">
                <div class="container">
                    <div class="row">
                        <p class="col-sm-12 text-center tm-font-light tm-color-white p-4 tm-margin-b-0">
                        Copyright &copy; <span class="tm-current-year">2021</span> PauerOf2
                        
                        <!-- - Design: <a rel="nofollow" href="https://www.tooplate.com" class="tm-color-primary tm-font-normal" target="_parent">Tooplate</a></p>         -->
                    </div>
                </div>                
            </footer>
        </div>
        
        <!-- load JS files -->
        <script src="{% static 'gildo/js/jquery-1.11.3.min.js' %}"></script>             <!-- jQuery (https://jquery.com/download/) -->
        <script src="{% static 'gildo/js/popper.min.js' %}"></script>                    <!-- https://popper.js.org/ -->       
        <script src="{% static 'gildo/js/bootstrap.min.js' %}"></script>                 <!-- https://getbootstrap.com/ -->
        <script src="{% static 'gildo/js/datepicker.min.js' %}"></script>                <!-- https://github.com/qodesmith/datepicker -->
        <script src="{% static 'gildo/js/jquery.singlePageNav.min.js' %}"></script>      <!-- Single Page Nav (https://github.com/ChrisWojcik/single-page-nav) -->
        <script src="{% static 'gildo/slick/slick.min.js' %}"></script>                  <!-- http://kenwheeler.github.io/slick/ -->
        <script src="{% static 'gildo/js/maps.js' %}"></script>

       <script>
            function setCarousel() {
                
                if ($('.tm-article-carousel').hasClass('slick-initialized')) {
                    $('.tm-article-carousel').slick('destroy');
                } 

                if($(window).width() < 438){
                    // Slick carousel
                    $('.tm-article-carousel').slick({
                        infinite: false,
                        dots: true,
                        slidesToShow: 1,
                        slidesToScroll: 1
                    });
                }
                else {
                 $('.tm-article-carousel').slick({
                        infinite: false,
                        dots: true,
                        slidesToShow: 2,
                        slidesToScroll: 1
                    });   
                }
            }

            function setPageNav(){
                if($(window).width() > 991) {
                    $('#tm-top-bar').singlePageNav({
                        currentClass:'active',
                        offset: 79
                    });   
                }
                else {
                    $('#tm-top-bar').singlePageNav({
                        currentClass:'active',
                        offset: 65
                    });   
                }
            }

            
           
            
       
            $(document).ready(function(){

                $(window).on("scroll", function() {
                    if($(window).scrollTop() > 100) {
                        $(".tm-top-bar").addClass("active");
                    } else {
                        //remove the background property so it comes transparent again (defined in your css)
                       $(".tm-top-bar").removeClass("active");
                    }
                });      

                

                // Date Picker
                const pickerCheckIn = datepicker('#inputCheckIn');
                const pickerCheckOut = datepicker('#inputCheckOut');
                
                // Slick carousel
                setCarousel();
                setPageNav();

                $(window).resize(function() {
                  setCarousel();
                  setPageNav();
                });

                // Close navbar after clicked
                $('.nav-link').click(function(){
                    $('#mainNav').removeClass('show');
                });

               

                // Update the current year in copyright
                $('.tm-current-year').text(new Date().getFullYear());                           
            });

        </script>             

</body>
</html>